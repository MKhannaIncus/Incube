<body class ="style-page">
<div class="view container-fluid">

  <!-- Summary Cards -->
  <div class="box1 row mb-3">
    <div class ="col-md-6">
      <div class="card text-white">
        <div class="card-body">
          <h5 class="card-title">Deal Information</h5>
          <td *ngFor="let deal of dealInformation" class="card-text">{{deal.comments}}</td>
        </div>
      </div>

    </div>
  </div>

  <!--Deal Information Table-->
  <div class="row mb-3">
    <div class="box2 col-md-6">
          <div class="description-container">
              <div class="w-100 content">
                <tbody>
                  <tr>
                    <th>Investment Date</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.investment_date | date }}</td>
                  </tr>
                  <tr>
                    <th>Maturity Date</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.maturity_date | date }}</td>
                  </tr>
                  <tr>
                    <th>Facility</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.facility | number:'1.0-0'}}</td>
                  </tr>
                  <tr>
                    <th>Opening Fee</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.opening_fee | number:'1.0-0' }}</td>
                  </tr>
                  <tr>
                    <th>Availability Fee</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.availability_fee | number:'1.0-0'}}</td>
                  </tr>
                  <tr>
                    <th>Minimum Multiple</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.minimum_multiple }}x</td>
                  </tr>
                  <tr>
                    <th>Underwriting IRR</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.underwriting_IRR }}</td>
                  </tr>
                  <tr>
                    <th>Underwriting NAV</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.underwriting_NAV | number:'1.0-0'}}</td>
                  </tr>
                  <tr>
                    <th>Underwriting MOIC</th>
                    <td *ngFor="let deal of dealInformation">{{ deal.underwriting_MOIC }}</td>
                  </tr>
                </tbody>
              </div>
          </div>
    </div>

<!--Facility Table-->
    <div class="box4 col-md-6">
      <div class="card text-white mb-3">
        <div class="card-body">
          <h5 class="card-title">Facility Information</h5>
          <div class="table-responsive">
            <table class="table table-hover w-100">
              <thead>
                <tr>
                  <th>Facility</th>
                  <th>Undrawn Amount</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{ facilityInformation?.facility | number:'1.0-0' }}</td>
                  <td>{{ facilityInformation?.undrawnAmount| number:'1.0-0' }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Transactions Table -->
  <div class="card mb-4  background-table-header">
    <div class="card-header d-flex justify-content-between align-items-center">
      <div class="col d-flex align-items-center">
        <h2 class="col mb-0 mr-3 headingPadding header-title">Transactions</h2>
        <button class=".btn new-transaction-button" (click)="togglePopup('repayment')">Repayment</button>
        <button class=".btn new-transaction-button margin-right" (click)="togglePopup('disbursement')">Disbursement</button>
      </div>
    </div>
    <div class="table-responsive w-100">
      <table class="table table-hover table-bordered w-100" align="left">
        <thead class="thead-dark">
          <tr>
            <th rowspan="2">Transaction ID</th>
            <th rowspan="2">Transaction Date</th>
            <th colspan="4" class="group-header">BOP</th>
            <th rowspan="2">Undrawn Amount</th>
            <th colspan="3" class="group-header">Accrued</th>
            <th colspan="4" class="group-header">Repayments</th>
            <th rowspan="2">Capitalized</th>
            <th colspan="4" class="group-header">EOP</th>
            <th rowspan="2">Amount Due EOP</th>
          </tr>
          <tr>
            <th>Total Amount</th>
            <th>Principal</th>
            <th>Cash Interest</th>
            <th>PIK Interest</th>
            <th>Cash Interest</th>
            <th>PIK Interest</th>
            <th>Undrawn Interest</th>
            <th>Cash Interest</th>
            <th>PIK Interest</th>
            <th>Principal</th>
            <th>Undrawn Fees</th>
            <th>Principal</th>
            <th>Cash Interest</th>
            <th>PIK Interest</th>
            <th>Undrawn Interest</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let transaction of transactions">
            <td>{{ transaction.transaction_Id }}</td>
            <td>{{ transaction.transaction_Date | date }}</td>
            <td>{{ transaction.amount_Due_BOP | number:'1.0-0' }}</td>
            <td>{{ transaction.principal_BOP | number:'1.0-0'  }}</td>
            <td>{{ transaction.cash_Interest_BOP }}</td>
            <td>{{ transaction.piK_Interest_BOP }}</td>
            <td>{{ transaction.undrawn_Amount | number:'1.0-0' }}</td>
            <td>{{ transaction.cash_Interest_Accrued | number:'1.0-0' }}</td>
            <td>{{ transaction.piK_Interest_Accrued | number:'1.0-0' }}</td>
            <td>{{ transaction.undrawn_Interest_Accrued | number:'1.0-0' }}</td>
            <td>({{ transaction.repayment_CashInterest| number:'1.0-0'  }})</td>
            <td>({{ transaction.repayment_PIKInterest | number:'1.0-0' }})</td>
            <td>({{ transaction.repayment_Principal | number:'1.0-0' }})</td>
            <td>({{ transaction.repayment_UndrawnFees | number:'1.0-0'}})</td>
            <td>{{ transaction.capitalized| number:'1.0-0'  }}</td>
            <td>{{ transaction.principal_EOP | number:'1.0-0' }}</td>
            <td>{{ transaction.cash_Interest_EOP | number:'1.0-0' }}</td>
            <td>{{ transaction.piK_Interest_EOP| number:'1.0-0'  }}</td>
            <td>{{ transaction.undrawn_Interest_EOP | number:'1.0-0'  }}</td>
            <td>{{ transaction.amount_Due_EOP| number:'1.0-0'  }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Popup Overlay for adding a new deal -->
<div *ngIf="popup" class="overlay">
  <div class="modal fade show" *ngIf="popup" style="display: block;" aria-hidden="!popup" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" (click)="closePopup()">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <ng-container *ngIf="isRepayment">
            <app-repayment></app-repayment>
          </ng-container>
          <ng-container *ngIf="isDisbursement">
            <app-disbursement></app-disbursement>
          </ng-container>
        </div>
      </div>
    </div>
  </div>
  </div>